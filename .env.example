# Sentinel - AI-Powered PII Protection Configuration
# Copy this file to .env and customize as needed

# Redis Configuration
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_TTL=86400  # 24 hours
# REDIS_PASSWORD=  # Optional

# PostgreSQL Configuration (for audit logs and API keys)
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=sentinel
POSTGRES_USER=sentinel
POSTGRES_PASSWORD=your_secure_password_here  # REQUIRED: Generate a strong password
POSTGRES_ECHO=false
POSTGRES_POOL_SIZE=5
POSTGRES_MAX_OVERFLOW=10

# Grafana Configuration
GRAFANA_ADMIN_PASSWORD=your_grafana_password_here  # REQUIRED: Change from default

# Authentication Configuration
ENABLE_API_KEY_AUTH=true
API_KEY_HEADER=X-API-Key

# Ollama LLM Configuration
OLLAMA_URL=http://ollama:11434/api/generate
OLLAMA_MODEL=phi3
OLLAMA_TIMEOUT=30.0

# Presidio Configuration
PRESIDIO_SCORE_THRESHOLD=0.0
PRESIDIO_LANGUAGE=en

# Prompt Engineering Configuration
# Options: v1_basic, v2_cot, v3_few_shot, v4_optimized
PROMPT_VERSION=v3_few_shot
USE_CHAIN_OF_THOUGHT=true
FEW_SHOT_EXAMPLES_COUNT=3

# Risk Scoring Configuration (GenAI Enhancement)
# Enable risk scoring instead of boolean leak detection
ENABLE_RISK_SCORING=true
# Purge keys immediately if risk score >= this threshold (0.7-1.0 = critical risk)
RISK_THRESHOLD_PURGE=0.7
# Send alert if risk score >= this threshold (0.5-0.7 = high risk)
RISK_THRESHOLD_ALERT=0.5
# Log for investigation if risk score >= this threshold (0.3-0.5 = medium risk)
RISK_THRESHOLD_LOG=0.3

# API Configuration
API_TITLE="Sentinel - AI-Powered PII Protection"
API_VERSION="1.0.0"
API_DEBUG=false

# Monitoring
ENABLE_METRICS=true
ENABLE_TRACING=false

# Policy Engine Configuration
ENABLE_POLICY_ENGINE=true
DEFAULT_POLICY_CONTEXT=general
ALLOW_POLICY_OVERRIDE=true

# Healthcare Policy (HIPAA-compliant)
HEALTHCARE_ENTITIES=["PERSON","PHONE_NUMBER","EMAIL_ADDRESS","US_SSN","DATE_TIME","LOCATION","IP_ADDRESS"]
HEALTHCARE_ALLOW_RESTORE=false
HEALTHCARE_MIN_CONFIDENCE=0.5

# Finance Policy (PCI-DSS)
FINANCE_ENTITIES=["PERSON","US_SSN","CREDIT_CARD","IBAN_CODE","PHONE_NUMBER","EMAIL_ADDRESS","US_BANK_NUMBER","US_DRIVER_LICENSE"]
FINANCE_ALLOW_RESTORE=false
FINANCE_MIN_CONFIDENCE=0.6
